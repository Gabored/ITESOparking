from tkinter import *
import tkinter as tk
import pyrebase
config = {
  "apiKey": "AIzaSyA1ijWIJ8vBWiDNm7AV4ZC1Dk4UpHQUvqs",
  "authDomain": "iteso-parking.firebaseapp.com",
  "databaseURL": "https://iteso-parking.firebaseio.com",
  "storageBucket": "iteso-parking.appspot.com",
  "serviceAccount": "E:\GitHub\ITESOparking\juan.json"
}
firebase = pyrebase.initialize_app(config)
active_user = ''
db = firebase.database()
all_users = db.child("Usuarios").get()


condicion = False

canvas = Canvas(0, width=1472, height=729)
frame = Frame(0, width=1008,height=500)
frame.pack()
canvas_iteso_logo = Canvas(0, width=224,height=182)
canvas_iteso_logo.pack()
img2 = PhotoImage(file='liteso.ppm')
canvas_iteso_logo.create_image(0,0,anchor=NW, image=img2)
img = PhotoImage(file='arboles.ppm')
canvas.create_image(0,0,anchor=NW, image=img)

canvas.pack()
def validuser():
    user = userio.get()
    correcto = False

    while correcto == False:
        if len(user) == 0:
            return "El usuario no puede estar vacio"

            break
        if user.isalnum() == True:
            return "El usuarop debe contener algun caracter especial"
            # contra = str(input("Intente de nuevo: "))

            break
        if len(user) > 20:
            return "El usuario no puede tener mas de 20 caracteres"

            break
        if len(user) < 20 and user.isalnum() == False and len(user)> 0:
            return True
            break






def validcontra():
    contra = password.get()
    correcto = False

    while correcto == False:
        if len(contra) < 8:
            return "Contraseña debe ser mayor a 8 caracteres"

            break
            #contra = str(input("Intente de nuevo: "))

        if contra.isalnum() == True:
            return "La contraseña debe contener algun caracter especial"

            break
            #contra = str(input("Intente de nuevo: "))

        if contra.isupper() == True or contra.islower() == True:
            return "La contraseña debe contener mayusculas y minusculas"

            break
            #contra = str(input("Intente de nuevo: "))

        if contra.count(" ") > 0:
            return "la contraseña no debe llevar espacios"

            break
            #contra = str(input("Intente de nuevo: "))

        if len(contra) > 8 and contra.isalnum() == False and contra.isupper() == False and contra.islower() == False and contra.count(" ") == 0 and validuser()==True:
            correcto = True
            return True
            break



def validbutton():
    button["state"] = DISABLED
    if validuser() == True and validcontra() == True:
        button["state"] = ACTIVE





def entry(txt):
    l=tk.Label(frame,text=txt,width=32)
    l.pack()
    e = tk.Entry(frame,text=txt,width=32, textvariable=userio)
    e.pack()

def register():
    print("Se registro")
    usr = userio.get()
    pswrd = password.get()
    json = {
        usr: {'password': pswrd}
    }
    db.child("Usuarios").update(json)





userio = tk.StringVar()
user = entry("Username")



j = tk.Label(frame,text = "Password",width=32).pack()
password = tk.StringVar()
e=tk.Entry(frame,show="*",text = "Password",width=32, textvariable = password).pack()

contraseña = password.get()

button =tk.Button(frame, state=DISABLED,text="Registrar", command = register)
button.pack()

buttovalid = tk.Button(frame,text="Validar",command = validbutton)
buttovalid.pack()




canvas.create_window(600, 282, anchor=NW, window=frame)
canvas.create_window(600, 100, anchor='nw', window=canvas_iteso_logo)
canvas.mainloop()
